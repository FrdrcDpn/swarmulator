clear all; clc;

fileID1 = fopen('xyTrajectory1.txt','w');
fileID2 = fopen('xyTrajectory2.txt','w');

               % Time, Waypoint, Orientation
trajectoryInfo1 = [0,   0,0,0,    0,0,0; ... % Initial position
                  0.3, -0.1,-0.1,0,  0,0,0; ...
                    
                  0.7, -1,-1,0,  0,0,0; ...
                  1,   -1.5,-1.5,0,    45,0,0; ...
                  1.3, -1.5,-1,0  90,0,0; ...
 
                  % 1, -1.5,-0.1,0,  0,0,0; ...
                   %1.5,   -1.5,0,0,    45,0,0; ...
                   %2.1, -1.5,0.1,0  90,0,0; ...
                  
                  2.7, -1.5,1,0,  90,0,0; ...
                  3,   -1.5,1.5,0,    135,0,0; ...
                  3.3, -1,1.5,0,  180,0,0; ...
 
                   %3.9, -0.1,1.5,0,  90,0,0; ...
                   %4,   0,1.5,0,    135,0,0; ...
                   %4.1, 0.1,1.5,0,  180,0,0; ...
                  
                  4.7, 1,1.5,0,  180,0,0; ...
                  5,   1.5,1.5,0,    225,0,0; ...
                  5.3, 1.5,1,0,  270,0,0; ...
 
                  % 5.9, 1.5,0.1,0,  180,0,0; ...
                  % 6,   1.5,0,0,    225,0,0; ...
                   %6.1, 1.5,-0.1,0,  270,0,0; ...
                  
                  6.7, 1.5,-1,0,  180,0,0; ...
                  7,   1.5,-1.5,0,    225,0,0; ...
                  7.3, 1,-1.5,0,  270,0,0; ...
                  
                   %7.9, 0.1,-1.5,0,  180,0,0; ...
                  % 8,   0,-1.5,0,    225,0,0; ...
                   %8.1, -0.1,-1.5,0,  270,0,0; ...
                  
                  8.7, -1,-1.5,0,  0,0,0; ...
                  9,   -1.5,-1.5,0,    45,0,0; ...
                  9.3, -1.5,-1,0  90,0,0; ...
 
                   %9.9, -1.5,-0.1,0,  0,0,0; ...
                   %10,   -1.5,0,0,    45,0,0; ...
                   %10.1, -1.5,0.1,0  90,0,0; ...
                  
                  10.7, -1.5,1,0,  90,0,0; ...
                  11,   -1.5,1.5,0,    135,0,0; ...
                  11.3, -1,1.5,0,  180,0,0; ...
 
                   %11, -0.1,1.5,0,  90,0,0; ...
                   %11.5,   0,1.5,0,    135,0,0; ...
                   %12.1, 0.1,1.5,0,  180,0,0; ...
                  
                  12.7, 1,1.5,0,  180,0,0; ...
                  13,   1.5,1.5,0,    225,0,0; ...
                  13.3, 1.5,1,0,  270,0,0; ...
 
                   %13.9, 1.5,0.1,0,  180,0,0; ...
                   %14,   1.5,0,0,    225,0,0; ...
                   %14.1, 1.5,-0.1,0,  270,0,0; ...
                  
                  14.7, 1.5,-1,0,  180,0,0; ...
                  15,   1.5,-1.5,0,    225,0,0; ...
                  15.3, 1,-1.5,0,  270,0,0; ...
                  
                   %15.9, 0.1,-1.5,0,  180,0,0; ...
                   %16,   0,-1.5,0,    225,0,0; ...
                   %16.1, -0.1,-1.5,0,  270,0,0; ...
                  
                  16.7, -1,-1.5,0,  270,0,0; ...
                  17,   -1.5,-1.5,0,    270,0,0]; % Final position

               % Time, Waypoint, Orientation
trajectoryInfo2 = [0,   0,0,0,    0,0,0; ... % Initial position
                  0.3,  -0.1,0.1,0,  0,0,0; ...
                    
                  2.7, -3.5,3.5,0,  0,0,0; ...
                  3,   -4,4,0,    45,0,0]; % Final position
                      
trajectory1 = waypointTrajectory(trajectoryInfo1(:,2:4), ...
    'TimeOfArrival',trajectoryInfo1(:,1)/2, ...
    'SampleRate',1000);
trajectory2 = waypointTrajectory(trajectoryInfo2(:,2:4), ...
    'TimeOfArrival',trajectoryInfo2(:,1)/2, ...
    'SampleRate',1000);

truePosition1 = zeros(trajectory1.SampleRate*trajectory1.TimeOfArrival(end)-1,3); 
truePosition2 = zeros(trajectory2.SampleRate*trajectory2.TimeOfArrival(end)-1,3); 
fprintf(fileID1,'%f %f \n',0,0);
fprintf(fileID2,'%f %f \n',0,0);
c = 1;

while ~isDone(trajectory1)
   truePosition1(c,:) = trajectory1();
   
    fprintf(fileID1,'%.2f %.2f \n',round(truePosition1(c,1),2), round(truePosition1(c,2),2));
     fprintf(fileID1,'%.2f %.2f \n',round(truePosition1(c,1),2), round(truePosition1(c,2),2));
      fprintf(fileID1,'%.2f %.2f \n',round(truePosition1(c,1),2), round(truePosition1(c,2),2));
       fprintf(fileID1,'%.2f %.2f \n',round(truePosition1(c,1),2), round(truePosition1(c,2),2));
        fprintf(fileID1,'%.2f %.2f \n',round(truePosition1(c,1),2), round(truePosition1(c,2),2));
         fprintf(fileID1,'%.2f %.2f \n',round(truePosition1(c,1),2), round(truePosition1(c,2),2));
          fprintf(fileID1,'%.2f %.2f \n',round(truePosition1(c,1),2), round(truePosition1(c,2),2));
           fprintf(fileID1,'%.2f %.2f \n',round(truePosition1(c,1),2), round(truePosition1(c,2),2));
            fprintf(fileID1,'%.2f %.2f \n',round(truePosition1(c,1),2), round(truePosition1(c,2),2));
             fprintf(fileID1,'%.2f %.2f \n',round(truePosition1(c,1),2), round(truePosition1(c,2),2));
    c = c + 1;

end

c = 1;

while ~isDone(trajectory2)
   truePosition2(c,:) = trajectory2();
   
    fprintf(fileID2,'%.2f %.2f \n',round(truePosition2(c,1),2), round(truePosition2(c,2),2));
     fprintf(fileID2,'%.2f %.2f \n',round(truePosition2(c,1),2), round(truePosition2(c,2),2));
      fprintf(fileID2,'%.2f %.2f \n',round(truePosition2(c,1),2), round(truePosition2(c,2),2));
       fprintf(fileID2,'%.2f %.2f \n',round(truePosition2(c,1),2), round(truePosition2(c,2),2));
        fprintf(fileID2,'%.2f %.2f \n',round(truePosition2(c,1),2), round(truePosition2(c,2),2));
         fprintf(fileID2,'%.2f %.2f \n',round(truePosition2(c,1),2), round(truePosition2(c,2),2));
          fprintf(fileID2,'%.2f %.2f \n',round(truePosition2(c,1),2), round(truePosition2(c,2),2));
           fprintf(fileID2,'%.2f %.2f \n',round(truePosition2(c,1),2), round(truePosition2(c,2),2));
            fprintf(fileID2,'%.2f %.2f \n',round(truePosition2(c,1),2), round(truePosition2(c,2),2));
             fprintf(fileID2,'%.2f %.2f \n',round(truePosition2(c,1),2), round(truePosition2(c,2),2));
    c = c + 1;

end
t=1:8499;
Datax=[t.' transpose(truePosition1(:,1)).'];
Datay=[t.' transpose(truePosition1(:,1)).'];

subplot(1,2,1) 
plot(truePosition2(:,2), truePosition2(:,1), 'b*','DisplayName','Trajectory')
xlim([-6 6])
ylim([-6 6])
xlabel('X position [m]')
ylabel('Y position [m]')
title("Trajectory agent 1")
lgd = legend;
lgd.NumColumns = 1;

subplot(1,2,2) 
plot(truePosition1(:,1), truePosition1(:,2), 'b*','DisplayName','Trajectory')

lgd = legend;
lgd.NumColumns = 1;

xlim([-2.5 2.5])
ylim([-2.5 2.5])
xlabel('X position [m]')
ylabel('Y position [m]')
title("Trajectory agent 2")

sgtitle('Trajectory agents Case Study 1') 


%figure(1)
%plot(truePosition1(:,1),truePosition1(:,2),'b*')
%title('Position')
%axis([-2,2,-2,2])
%axis square
%%xlabel('X')
%ylabel('Y')
%grid on
%hold on


%figure(2)
%plot(truePosition2(:,1),truePosition2(:,2),'b*')
%title('Position')
%axis([-2,2,-2,2])
%axis square
%xlabel('X')
%ylabel('Y')
%grid on
%hold on
